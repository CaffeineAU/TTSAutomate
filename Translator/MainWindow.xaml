<Window x:Class="TTSTranslate.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TTSTranslate"
        xmlns:self="clr-namespace:TTSTranslate.Commands"
        mc:Ignorable="d"
        Title="TTSTranslate" Height="800" Width="1000" FontSize="16" Background="#FF4692D1" Icon="speech-bubble.ico" Closing="Window_Closing">
    <Window.CommandBindings>
        <CommandBinding Command="self:CustomCommands.BrowsePhraseFileCommand" Executed="BrowsePhraseFileCommand_Executed" />
        <CommandBinding Command="self:CustomCommands.CreatePhraseFileCommand" Executed="CreatePhraseFileCommand_Executed" />
        <CommandBinding Command="self:CustomCommands.BrowseOutputDirectoryCommand" Executed="BrowseOutputDirectoryCommand_Executed" />
        <CommandBinding Command="self:CustomCommands.StartDownloadingCommand" CanExecute="StartDownloadingCommand_CanExecute" Executed="StartDownloadingCommand_Executed" />
        <CommandBinding Command="self:CustomCommands.StopDownloadingCommand" CanExecute="StopDownloadingCommand_CanExecute" Executed="StopDownloadingCommand_Executed" />
        <CommandBinding Command="self:CustomCommands.SavePhraseFileCommand" CanExecute="SavePhraseFileCommand_CanExecute" Executed="SavePhraseFileCommand_Executed" />
        <CommandBinding Command="self:CustomCommands.SaveAsPhraseFileCommand" CanExecute="SavePhraseFileCommand_CanExecute" Executed="SaveAsPhraseFileCommand_Executed" />
        <CommandBinding Command="self:CustomCommands.InsertRowsAboveCommand" CanExecute="InsertRowsAboveCommand_CanExecute" Executed="InsertRowsAboveCommand_Executed" />
        <CommandBinding Command="self:CustomCommands.InsertRowsBelowCommand" CanExecute="InsertRowsBelowCommand_CanExecute" Executed="InsertRowsBelowCommand_Executed" />
    </Window.CommandBindings>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="120"/>
            <ColumnDefinition Width="140"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="210"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="40"/>
            <RowDefinition Height="40"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="60"/>
            <RowDefinition Height="60"/>
            <RowDefinition Height="60"/>
            <RowDefinition Height="60"/>
        </Grid.RowDefinitions>
        <DataGrid x:Name="WordsListView" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="2" Grid.RowSpan="4" Grid.ColumnSpan="3" RowHeaderWidth="35" ItemsSource="{Binding Path=PhraseItems, UpdateSourceTrigger=PropertyChanged}" AutoGenerateColumns="False" CellEditEnding="WordsListView_CellEditEnding"  Margin="5" PreviewKeyDown="WordsListView_PreviewKeyDown" AlternatingRowBackground="#FFE5EDF7" SelectionUnit="CellOrRowHeader" EnableRowVirtualization="False" SelectionChanged="WordsListView_SelectionChanged"  >
            <DataGrid.Resources>
                <local:RowIndexConverter x:Key="RowIndexConverter"/>
            </DataGrid.Resources>
            <DataGrid.RowHeaderTemplate>
                <DataTemplate>
                    <TextBlock>
                        <TextBlock.Text>
                            <MultiBinding Converter="{StaticResource RowIndexConverter}"  UpdateSourceTrigger="PropertyChanged">
                                <Binding RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType=DataGridRow}" Mode="TwoWay"/>
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                </DataTemplate>
            </DataGrid.RowHeaderTemplate>
            <DataGrid.Columns>
                <DataGridTextColumn  Header="Folder" Binding="{Binding Folder}" />
                <DataGridTextColumn  Header="Filename" Binding="{Binding FileName}" />
                <DataGridTextColumn  Header="Phrase to Speak" Binding="{Binding Phrase}"/>
                <DataGridTemplateColumn Header="Play">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Click="PlayButton_Click" CommandParameter="{Binding FullPathAndFile}"  Content="Play">
                                <Button.Style>
                                    <Style TargetType="{x:Type Button}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding DownloadComplete}" Value="False">
                                                <Setter Property="IsEnabled" Value="False" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
        <Label  Content="Phrase File" HorizontalAlignment="Stretch" VerticalContentAlignment="Center" VerticalAlignment="Stretch" Margin="5" Grid.ColumnSpan="2" Grid.Column="1"/>
        <TextBox HorizontalAlignment="Stretch" TextWrapping="Wrap" Text="{Binding Path=PhraseFileName}"  VerticalContentAlignment="Center" VerticalAlignment="Stretch"  Grid.Column="2" Margin="5" IsReadOnly="True" >
            <TextBox.Style>
                <Style TargetType="{x:Type TextBox}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding NeedToSave}" Value="True">
                            <Setter Property="Background" Value="Red" />
                            <Setter Property="Foreground" Value="White" />
                            <Setter Property="FontStyle" Value="Italic" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBox.Style>
        </TextBox>
        <Label  Content="Output Directory" HorizontalAlignment="Stretch" VerticalContentAlignment="Center" VerticalAlignment="Stretch" Grid.Row="1" Margin="5" Grid.Column="1"/>
        <TextBox HorizontalAlignment="Stretch" TextWrapping="Wrap" Text="{Binding Path=OutputDirectoryName}" VerticalContentAlignment="Center" VerticalAlignment="Stretch"  Grid.Column="2" Grid.Row="1" Margin="5" IsReadOnly="True"/>
        <StackPanel Orientation="Horizontal" Grid.Row="4" HorizontalAlignment="Stretch"  Grid.ColumnSpan="2"/>
        <ProgressBar HorizontalAlignment="Stretch"  VerticalAlignment="Stretch" Grid.Row="6" Grid.Column="2" Margin="5" Maximum="{Binding DownloadCount}" Value="{Binding DownloadProgress}"/>
        <StackPanel Grid.Column="3" HorizontalAlignment="Stretch"  Grid.Row="0" Grid.RowSpan="4" VerticalAlignment="Stretch" Margin="5" >
            <Button  Content="Open Phrase File..." HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  Grid.Column="3" Margin="5" Command="self:CustomCommands.BrowsePhraseFileCommand"/>
            <Button  Content="Select Output Directory..." HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  Grid.Column="3" Grid.Row="1" Margin="5" Command="self:CustomCommands.BrowseOutputDirectoryCommand"/>
            <Button  Content="Create new Phrase File" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  Grid.Column="3" Margin="5" Command="self:CustomCommands.CreatePhraseFileCommand"/>
            <Label Content="TTS Provider"/>
            <ComboBox ItemsSource="{Binding Path=TTSEngines}" SelectedValue="{Binding SelectedEngine, Mode=TwoWay}" SelectionChanged="EngineComboBox_SelectionChanged" />
            <TextBlock Text="Note: Only WAV files will be created" TextWrapping="Wrap" Foreground="#FF970000" Visibility="{Binding Path=UseLocal}"/>
            <Label Content="{Binding SpeechRate}" ContentStringFormat="Speech rate: {0}" Visibility="{Binding Path=UseLocal}" />
            <Slider Visibility="{Binding Path=UseLocal}" Minimum="-10" SmallChange="1" Value="{Binding SpeechRate}" TickPlacement="BottomRight" ValueChanged="Slider_ValueChanged"/>
            <Label Content="{Binding Volume}" ContentStringFormat="Volume: {0}" Visibility="{Binding Path=UseLocal}" />
            <Slider Visibility="{Binding Path=UseLocal}" Minimum="0" Maximum="100" SmallChange="1" Value="{Binding Volume}" TickPlacement="BottomRight" ValueChanged="Slider_ValueChanged" TickFrequency="10" LargeChange="10"/>
            <Label Content="Language" Visibility="{Binding Path=UseWeb}" />
            <ComboBox ItemsSource="{Binding Path=Cultures}" DisplayMemberPath="DisplayName" Visibility="{Binding Path=UseWeb}" SelectedValue="{Binding SelectedCulture, Mode=TwoWay}" SelectionChanged="VoiceComboBox_SelectionChanged" />
        </StackPanel>
        <Button  Content="{Binding SelectedRowCount}" ContentStringFormat="Insert {0} rows(s) above" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  Grid.Column="3" Grid.Row="3" Margin="5" Command="self:CustomCommands.InsertRowsAboveCommand"/>
        <Button  Content="{Binding SelectedRowCount}" ContentStringFormat="Insert {0} rows(s) below" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  Grid.Column="3" Grid.Row="4" Margin="5" Command="self:CustomCommands.InsertRowsBelowCommand"/>
        <Button  Content="Save Phrase File" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  Grid.Column="3" Grid.Row="5" Margin="5" Command="self:CustomCommands.SavePhraseFileCommand"/>
        <Button  Content="Save Phrase File As..." HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  Grid.Column="3" Grid.Row="6" Margin="5" Command="self:CustomCommands.SaveAsPhraseFileCommand"/>
        <Image x:Name="image" Source="{Binding HeaderImage}" HorizontalAlignment="Stretch" Margin="5"  VerticalAlignment="Stretch" Grid.RowSpan="2"/>
        <Button  Content="Stop!" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Command="self:CustomCommands.StopDownloadingCommand" Margin="5" Grid.Column="1" Grid.Row="6"/>
        <Button  Content="Go!" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Command="self:CustomCommands.StartDownloadingCommand" Margin="5" Grid.Column="0" Grid.Row="6"/>

    </Grid>
</Window>
